var Ve=Object.defineProperty,He=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ie=(e,a,l)=>a in e?Ve(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,O=(e,a)=>{for(var l in a||(a={}))Ye.call(a,l)&&ie(e,l,a[l]);if(se)for(var l of se(a))Re.call(a,l)&&ie(e,l,a[l]);return e},ue=(e,a)=>He(e,Xe(a));var oe=(e,a,l)=>new Promise((S,k)=>{var L=K=>{try{y(l.next(K))}catch(_){k(_)}},s=K=>{try{y(l.throw(K))}catch(_){k(_)}},y=K=>K.done?S(K.value):Promise.resolve(K.value).then(L,s);y((l=l.apply(e,a)).next())});import{ap as ze,d as _e,f as Ee,ah as Ge,c as M,w as $,Z as m,_ as U,u,ae as Je,ab as I,a8 as q,a9 as j,G as de,a0 as he,a1 as fe,k as v,F as z,aa as Ze,aj as qe,ak as We,B as Qe,l as ye,r as pe,J as R,h as V,o as et,m as ke,A as ge,ac as tt,i as nt}from"./vue-COhTiP8A.js";import{az as at,h as lt,V as ct,y as Q,u as rt,aA as Se,H as st,aB as it,a7 as ut,aC as ot,X as Ke,Z as dt,r as xe}from"./entry/index-DgetGCEO-1709791205404.js";import{aX as ht,aY as ft,aZ as yt,x as pt,a_ as kt,a$ as gt,D as St,l as Kt,f as ee,b0 as xt,o as Ct,e as W,G as At,al as vt,aG as Ce,ad as Lt,v as bt,ah as Ae}from"./antd-BS7GgtZr.js";import{u as _t}from"./useContextMenu-Cua2sZBU.js";function te(e,a){return a?typeof a=="string"?` ${e}--${a}`:Array.isArray(a)?a.reduce((l,S)=>l+te(e,S),""):Object.keys(a).reduce((l,S)=>l+(a[S]?te(e,S):""),""):""}function Et(e){return(a,l)=>(a&&typeof a!="string"&&(l=a,a=""),a=a?`${e}__${a}`:e,`${a}${te(a,l)}`)}function Te(e){return[Et(`${at}-${e}`)]}const ve=Symbol(),Le=Symbol();function Tt(e,a){if(!ft(e)||e[Le])return e;const{values:l,required:S,default:k,type:L,validator:s}=e,y=l||s?K=>{let _=!1,b=[];if(l&&(b=[...l,k],_||(_=b.includes(K))),s&&(_||(_=s(K))),!_&&b.length>0){const h=[...new Set(b)].map(d=>JSON.stringify(d)).join(", ");ze(`Invalid prop: validation failed${a?` for prop "${a}"`:""}. Expected one of [${h}], got value ${JSON.stringify(K)}.`)}return _}:void 0;return{type:typeof L=="object"&&Object.getOwnPropertySymbols(L).includes(ve)&&L?L[ve]:L,required:!!S,default:k,validator:y,[Le]:!0}}const Bt=e=>ht(Object.entries(e).map(([a,l])=>[a,Tt(l,a)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const wt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Dt=Bt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Ft={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Nt=_e({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:a}){const l=Ee(""),[S]=Te("tree-header"),k=e,L=a,s=Ge(),{t:y}=lt(),K=M(()=>["mr-1","w-full",{"ml-5":s.headerTitle||k.title}]),_=M(()=>{const{checkable:t}=k,r=[{label:y("component.tree.expandAll"),value:T.EXPAND_ALL},{label:y("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:t}];return t?[{label:y("component.tree.selectAll"),value:T.SELECT_ALL},{label:y("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:t},...r,{label:y("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:y("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:r}),b=({key:t})=>{var r,i,o,c;switch(t){case T.SELECT_ALL:(r=k.checkAll)==null||r.call(k,!0);break;case T.UN_SELECT_ALL:(i=k.checkAll)==null||i.call(k,!1);break;case T.EXPAND_ALL:(o=k.expandAll)==null||o.call(k,!0);break;case T.UN_EXPAND_ALL:(c=k.expandAll)==null||c.call(k,!1);break;case T.CHECK_STRICTLY:L("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:L("strictly-change",!0);break}};function h(t){L("search",t)}const d=rt(h,200);return $(()=>l.value,t=>{d(t)}),$(()=>k.searchText,t=>{t!==l.value&&(l.value=t)}),(t,r)=>(m(),U("div",{class:fe([u(S)(),"flex mb-1 px-2 py-1.5 items-center"])},[u(s).headerTitle?Je(t.$slots,"headerTitle",{key:0}):I("",!0),!u(s).headerTitle&&t.title?(m(),q(u(ct),{key:1,helpMessage:t.helpMessage},{default:j(()=>[de(he(t.title),1)]),_:1},8,["helpMessage"])):I("",!0),t.search||t.toolbar?(m(),U("div",Ft,[t.search?(m(),U("div",{key:0,class:fe(K.value)},[v(u(yt),{placeholder:u(y)("common.searchText"),size:"small",allowClear:"",value:l.value,"onUpdate:value":r[0]||(r[0]=i=>l.value=i)},null,8,["placeholder","value"])],2)):I("",!0),t.toolbar?(m(),q(u(St),{key:1,onClick:r[1]||(r[1]=Qe(()=>{},["prevent"]))},{overlay:j(()=>[v(u(pt),{onClick:b},{default:j(()=>[(m(!0),U(z,null,Ze(_.value,i=>(m(),U(z,{key:i.value},[v(u(kt),qe(We({key:i.value})),{default:j(()=>[de(he(i.label),1)]),_:2},1040),i.divider?(m(),q(u(gt),{key:0})):I("",!0)],64))),128))]),_:1})]),default:j(()=>[v(Q,{icon:"ion:ellipsis-vertical"})]),_:1})):I("",!0)])):I("",!0)],2))}}),mt=({icon:e})=>e?Kt(e)?ye(Q,{icon:e,class:"mr-2"}):ye(Q):null;function Mt(e,a){function l(h){const d=[],t=h||u(e),{key:r,children:i}=u(a);if(!i||!r)return d;for(let o=0;o<t.length;o++){const c=t[o];d.push(c[r]);const p=c[i];p&&p.length&&d.push(...l(p))}return d}function S(h){const d=[],t=h||u(e),{key:r,children:i}=u(a);if(!i||!r)return d;for(let o=0;o<t.length;o++){const c=t[o];c.disabled!==!0&&c.selectable!==!1&&d.push(c[r]);const p=c[i];p&&p.length&&d.push(...S(p))}return d}function k(h,d){const t=[],r=d||u(e),{key:i,children:o}=u(a);if(!o||!i)return t;for(let c=0;c<r.length;c++){const p=r[c],E=p[o];h===p[i]?(t.push(p[i]),E&&E.length&&t.push(...l(E))):E&&E.length&&t.push(...k(h,E))}return t}function L(h,d,t){if(!h)return;const r=t||u(e),{key:i,children:o}=u(a);if(!(!o||!i))for(let c=0;c<r.length;c++){const p=r[c],E=p[o];if(p[i]===h){r[c]=O(O({},r[c]),d);break}else E&&E.length&&L(h,d,p[o])}}function s(h=1,d,t=1){if(!h)return[];const r=[],i=d||u(e)||[];for(let o=0;o<i.length;o++){const c=i[o],{key:p,children:E}=u(a),G=p?c[p]:"",P=E?c[E]:[];r.push(G),P&&P.length&&t<h&&(t+=1,r.push(...s(h,P,t)))}return r}function y({parentKey:h=null,node:d,push:t="push"}){const r=ee(u(e));if(!h){r[t](d),e.value=r;return}const{key:i,children:o}=u(a);!o||!i||(Se(r,c=>{if(c[i]===h)return c[o]=c[o]||[],c[o][t](d),!0}),e.value=r)}function K({parentKey:h=null,list:d,push:t="push"}){const r=ee(u(e));if(!(!d||d.length<1))if(h){const{key:i,children:o}=u(a);if(!o||!i)return;Se(r,c=>{if(c[i]===h){c[o]=c[o]||[];for(let p=0;p<d.length;p++)c[o][t](d[p]);return e.value=r,!0}})}else{for(let i=0;i<d.length;i++)r[t](d[i]);e.value=r;return}}function _(h,d){if(!h)return;const t=d||u(e),{key:r,children:i}=u(a);if(!(!i||!r))for(let o=0;o<t.length;o++){const c=t[o],p=c[i];if(c[r]===h){t.splice(o,1);break}else p&&p.length&&_(h,c[i])}}function b(h,d,t){if(!h&&h!==0)return null;const r=d||u(e),{key:i,children:o}=u(a);return i?(r.forEach(c=>{if(t!=null&&t.key||(t==null?void 0:t.key)===0)return t;if(c[i]===h){t=c;return}c[o]&&c[o].length&&(t=b(h,c[o],t))}),t||null):null}return{deleteNodeByKey:_,insertNodeByKey:y,insertNodesByKey:K,filterByLevel:s,updateNodeByKey:L,getAllKeys:l,getChildrenKeys:k,getEnabledKeys:S,getSelectedNode:b}}function be(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!nt(e)}const jt=_e({name:"BasicTree",inheritAttrs:!1,props:Dt,emits:wt,setup(e,{attrs:a,slots:l,emit:S,expose:k}){const[L]=Te("tree"),s=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),y=pe({startSearch:!1,searchText:"",searchData:[]}),K=Ee([]),[_]=_t(),b=M(()=>{const{fieldNames:n}=e;return O({children:"children",title:"title",key:"key"},n)}),h=M(()=>{let n=ue(O(O({blockNode:!0},a),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,fieldNames:u(b),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,S("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,S("update:selectedKeys",f)},onCheck:(f,x)=>{let g=R(s.checkedKeys);if(st(g)&&y.startSearch){const A=x.node.eventKey;g=xt(g,G(A)),x.checked&&g.push(A),s.checkedKeys=g}else s.checkedKeys=f;const C=R(s.checkedKeys);S("update:value",C),S("check",C,x)},onRightClick:De});return Ct(n,"treeData","class")}),d=M(()=>y.startSearch?y.searchData:u(K)),t=M(()=>!d.value||d.value.length===0),{deleteNodeByKey:r,insertNodeByKey:i,insertNodesByKey:o,filterByLevel:c,updateNodeByKey:p,getAllKeys:E,getChildrenKeys:G,getEnabledKeys:P,getSelectedNode:Be}=Mt(K,b);function we(n,f){return!f&&e.renderIcon&&W(e.renderIcon)?e.renderIcon(n):f}function De(x){return oe(this,arguments,function*({event:n,node:f}){var F;const{rightMenuList:g=[],beforeRightClick:C}=e;let A={event:n,items:[]};if(C&&W(C)){let B=yield C(f,n);Array.isArray(B)?A.items=B:Object.assign(A,B)}else A.items=g;(F=A.items)!=null&&F.length&&(A.items=A.items.filter(B=>!B.hidden),_(A))})}function Fe(){return u(K)}function H(n){s.expandedKeys=n}function Ne(){return s.expandedKeys}function ne(n){s.selectedKeys=n}function me(){return s.selectedKeys}function ae(n){s.checkedKeys=n}function Me(){return s.checkedKeys}function le(n){s.checkedKeys=n?P():[]}function J(n){s.expandedKeys=n?E():[]}function Oe(n){s.checkStrictly=n}$(()=>e.searchValue,n=>{n!==y.searchText&&(y.searchText=n)},{immediate:!0}),$(()=>e.treeData,n=>{n&&Z(y.searchText)});function Z(n){if(n!==y.searchText&&(y.searchText=n),S("update:searchValue",n),!n){y.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:g,checkOnSearch:C,selectedOnSearch:A}=u(e);y.startSearch=!0;const{title:F,key:B}=u(b),D=[];if(y.searchData=it(u(K),w=>{var X,Y;const N=f?f(n,w,u(b)):(Y=(X=w[F])==null?void 0:X.includes(n))!=null?Y:!1;return N&&D.push(w[B]),N},u(b)),g){const w=ut(y.searchData).map(N=>N[B]);w&&w.length&&H(w)}C&&x&&D.length&&ae(D),A&&D.length&&ne(D)}function Ie(n,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(n))H([...s.expandedKeys,n]);else{const x=[...s.expandedKeys],g=x.findIndex(C=>C===n);g!==-1&&x.splice(g,1),H(x)}}V(()=>{K.value=e.treeData}),et(()=>{const n=parseInt(e.defaultExpandLevel);n>0?s.expandedKeys=c(n):e.defaultExpandAll&&J(!0)}),V(()=>{s.expandedKeys=e.expandedKeys}),V(()=>{s.selectedKeys=e.selectedKeys}),V(()=>{s.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{s.checkedKeys=R(e.value||[])},{immediate:!0}),$(()=>s.checkedKeys,()=>{const n=R(s.checkedKeys);S("update:value",n),S("change",n)}),V(()=>{s.checkStrictly=e.checkStrictly});const $e={getTreeData:Fe,setExpandedKeys:H,getExpandedKeys:Ne,setSelectedKeys:ne,getSelectedKeys:me,setCheckedKeys:ae,getCheckedKeys:Me,insertNodeByKey:i,insertNodesByKey:o,deleteNodeByKey:r,updateNodeByKey:p,getSelectedNode:Be,checkAll:le,expandAll:J,filterByLevel:n=>{s.expandedKeys=c(n)},setSearchValue:n=>{Z(n)},getSearchValue:()=>y.searchText};function Pe(n){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,g)=>{var A;let C=!0;return W(x.show)?C=(A=x.show)==null?void 0:A.call(x,n):Ae(x.show)&&(C=x.show),C?v("span",{key:g,class:L("action")},[x.render(n)]):null})}const Ue=M(()=>{const n=ee(d.value);return ot(n,(f,x)=>{var re;const g=y.searchText,{highlight:C}=u(e),{title:A,key:F,children:B}=u(b),D=we(f,f.icon),w=Lt(f,A),N=g?w.indexOf(g):-1,X=y.startSearch&&!bt(g)&&C&&N!==-1,Y=`color: ${Ae(C)?"#f50":C}`,je=X?v("span",{class:(re=u(h))!=null&&re.blockNode?`${L("content")}`:""},[v("span",null,[w.substr(0,N)]),v("span",{style:Y},[g]),v("span",null,[w.substr(N+g.length)])]):w,ce=D?v(mt,{icon:D},null):l.icon?v("span",{class:"mr-2"},[xe(l,"icon")]):null;return f[A]=v("span",{class:`${L("title")}`,onClick:Ie.bind(null,f[F],f[B])},[l!=null&&l.title?v(z,null,[ce,xe(l,"title",f)]):v(z,null,[ce,je,v("span",{class:L("actions")},[Pe(f)])])]),f}),n});return k($e),()=>{let n,f;const{title:x,helpMessage:g,toolbar:C,search:A,checkable:F}=e,B=x||C||A||l.headerTitle,D={height:"calc(100% - 38px)"};return v("div",{class:[L(),"h-full",a.class]},[B&&v(Nt,{checkable:F,checkAll:le,expandAll:J,title:x,search:A,toolbar:C,helpMessage:g,onStrictlyChange:Oe,onSearch:Z,searchText:y.searchText},be(n=Ke(l))?n:{default:()=>[n]}),v(At,{wrapperClassName:u(e.treeWrapperClassName),spinning:u(e.loading),tip:"加载中..."},{default:()=>[ke(v(dt,{style:D},{default:()=>[v(vt,tt(u(h),{showIcon:!1,treeData:Ue.value}),be(f=Ke(l,["title"]))?f:{default:()=>[f]})]}),[[ge,!u(t)]]),ke(v(Ce,{image:Ce.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ge,u(t)]])]})])}}});export{jt as _};
